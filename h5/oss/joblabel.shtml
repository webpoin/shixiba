<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>实习吧-职位标签管理</title>
<link href="/sxb/oss/css/my.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/sxb/js/jquery-1.9.1.min.js"></script>
<script src="/sxb/js/jquery.ui.core.js"></script>
<script src="/sxb/js/jquery.ui.datepicker.js"></script>
<script src="/sxb/js/jquery.ui.datepicker-zh-CN.js"></script>
<script type="text/javascript" src="/sxb/js/wuliu.js"></script>
<script type="text/javascript" src="/sxb/js/comm_page.js"></script>
<link rel="stylesheet" type="text/css" href="/sxb/oss/css/jquery.ui.all.css" />
<link rel="stylesheet" type="text/css" href="/sxb/oss/css/jquery-ui-1.10.4.custom.css" />
<link rel="stylesheet" type="text/css" href="/sxb/oss/css/jquery.ui.datepicker.css" />
<script type="text/javascript" src="/track/js/ccdate.js"></script>
<style type="text/css">
.register_content{
	width:770px;
	float:left;
	width:760px;
	padding-left:20px;
	}
.register_head{
	height: 38px;
	background-color:#90BFFF;
	color:#FFFFFF;
    line-height: 38px;
    border-bottom: solid 1px #EAEAEA;
    padding-right: 10px;
    text-align:left;
	font-size: 18px;
	font-weight: normal;
	padding-left: 18px;
	font-weight: bold;
  }	
.tr_set td{
	padding:10px 0;}
.td_1{
	font-size: 16px;
	width: 150px;
	padding-right: 10px;
	text-align: right;
	vertical-align:middle;
	color: #404040;
	padding-top: 15px;
    }
.td_2
{
font-size: 16px;
}
.login_text{
	 border: 1px solid #A0A0A0;
	height: 18px;
	float: left;
	width: 216px;
	margin-right: 10px;
	padding: 7px 10px;
	line-height: 18px;
	outline: 0 none;
	}
.login_text:focus{
	border:1px solid #6482B9;}
.td_3{
	font-size:12px;
	color:#A9A9A9;;
	text-align:left;}	
.login_commit{
	float:left;
	display: inline-block;
    border: 0;
    width: 240px;
    height: 36px;
    font-size:18px;
    cursor: pointer;
    background-color:#4CB7B7;
	color:#FFFFFF;
}
</style>

<style type="text/css">
.nav-box a{
	display:block;
	text-decoration:none;
	float:left;
	border-left: 2px solid #448EF3;
    border-right: 2px solid #448EF3;
	color:white;
	font-size:16px;
	height:36px;
	padding:0 35px;
	}
a.nav-select{
	background-color:#FF9E40;
	border-left:2px solid #FFFFFF;
	border-right:2px solid #FFFFFF;}
	.nav a:hover, .nav a:link, .nav a:visited, .nav a:active{
		text-decoration:none;}
		.ff{
			float:left;}
.nav-box a:hover {
    background-color: #6CA8FA;
    border-left: 2px solid #6CA8FA;
    border-right: 2px solid #6CA8FA;
    color: #FFFFFF;
}
.nav-box a.nav-select {
    background-color: #FF9E40;
    border-left: 2px solid #FFFFFF;
    border-right: 2px solid #FFFFFF;
}
a.fr{
	float:right;}

.column_1 {
	float:left;
	width:134px;
	font-size:16px;
    }
.column_1 a{
	font-size:16px;
	display:block;
	height:37px;
	line-height:37px;
	background-color:#F5F5F5;
	color:#333333;
    border-bottom: 1px solid #FFFFFF;
	padding-left:16px;
	}
.column_1 a.a_selected{
	background-color:#448EF3;
	border-bottom: 1px solid #FFFFFF;
	color:#FFFFFF;}	
.column_1 a:hover{
	text-decoration:none;
	color:#FFFFFF;
	background-color:#448EF3;
	border-bottom:1px solid #FFFFFF;}
.column_2 {
	float:right;
	width:840px;
	padding-left:20px;
}
.head_search{
	float:right;
	/*width:728px;*/
	width:100%;
	
	padding:20px 0px;
	text-align:center;
	border:1px dashed #C4E1FF;
	/*	border:1px solid #448EF3;*/
	text-align: left;
	}
.input_1{
	width:250px;
	border:1px solid #E9EFF6;
	cursor:text;
	height:22px;
	line-height:22px;
	font-size:14px;
	padding:3px 5px;
	margin-right: 15px;
	}
.submit_1{
	width:150px;
	border:0;
	cursor:pointer;
	height:30px;
	line-height:30px;
	font-size:16px;
	color:#ffffff;
	background-color:#FF9E40;
	display: block;
	float:right;
	text-align:center;
	
	}		
.top_title {
	float:left;
	width:100%;
	font-size:16px;
	}
.top_title a {
	font-size:12px;
	}
.table_title{
	color:#999999;
	background-color: #F4F9FF;
    border-top: 1px solid #B9D5FD;
	font-size:13px;
    width: 100%;}

.table_body{
width:100%;
   padding-top:5px;
	float:left;}
.table_body table{
	width:100%;}
.tr_pad{
	border-bottom:1px dashed #B9D5FD;
}
.tr_pad td{
	padding-top: 5px;
	padding-bottom: 5px;
	word-break:break-all;
}
tbody tr:hover {
    background-color: #fef6c1 !important;
	}
.w0{
	width:20px;
   }
.w1{
	width:100px;
	padding-left:5px;
   }
.w2{
	width:110px;
	padding-right:0px;
	}
.w3{
	width:100px;
	padding-right:0px;
	}
.w4{
	width:80px;
	padding-left:0px;}
.w5{
	width:110px;
	padding-left:5px;}
.w6{
	width:170px;
	padding-left:5px;}
.w8{
	width:50px;
	padding-left:5px;}
.w99{
	width:10%;
	padding-left:0px;}
.pages{
	float:right;
	width:100%;
	}
.sming {
	position:relative;
	border-top:1px solid silver;
	height:90px;
	text-align:center;
	overflow:hidden;
	z-index:4;
}
.sming a:hover{
	color:red;}
.sm1{
	position: absolute;
	left:80px;
	width:160px;}
.sm2{
	position:relative;
	float:right;
	width:860px;
		}
.sm2 a{
	display:inline;
	margin-right:14px;}
.sm2_b span{
	display:inline;
	margin-right:14px;}
	
td,th,th input,td input{
	vertical-align:middle;
}
table{
font-size:11px;
}


</style>
</head>
<body>
<!--script>islogin("66");</script-->
<!--#include virtual="/sxb/oss/head.html"-->

<div class="container w1024 mt5">

<!--#include virtual="/sxb/oss/left.html"-->	

	 <div class="column_2 mt10">
		 <!--div class="head_search "  >
		 	<div style="padding-left: 10px;padding-right: 10px;">
		 		<div style="margin-bottom: 10px;">
			 		<label style="font-size: 16px;">开始时间：</label>
			 			<input name="txtStart" id="txtStart" class="txt" placeholder=""/>
			 		<label style="font-size: 16px;">&nbsp;&nbsp;结束时间：</label>
			 			<input name="txtEnd" id="txtEnd" class="txt"  placeholder=""/>
		 		</div>
		 		<label style="font-size: 16px;">搜关键字：</label>
				 <input class="input_1" type="text" name="搜索" value=""  />
				 <a class="submit_1" type="submit"  >搜&nbsp;&nbsp;索</a>
			 </div>
		 </div-->
		 
		 <div style="font-size: 16px;">
			<span>职位标签管理：</span>
			<span id="fid" style="display: none;"></span>
			<a style="float:right;" href="/sxb/oss/job.shtml" target="_self">返回到职位列表</a>
		</div>
		 
		 <div class="register_body" style="padding-bottom: 10px;">
			<div class="register_form1">
			<table>
				<tbody>
							<tr class="tr_set">
								<td class="td_1"><label>选择职位标签：</label></td>
								<td class="td_2" >
									<select id="flabels" style="height:28px; line-height:28px; font-size:16px;display: inline;width: 237px;" tabindex="2">
										<!--option selected="selected"  value="1" >个人标签</option>
										<option  value="2">企业标签</option-->
							  		</select>
					        	</td>
								
								<td class="td_3">
								<span>&nbsp;&nbsp;</span>
								<a href="/sxb/oss/labeladd.shtml" >自定义标签</a>
								</td>
							</tr>
							<!--tr class="tr_set">
								<td class="td_1"><label>标签文件ID：</label></td>
								<td class="td_2">	<input id="ffileid" class="login_text" type="text"  tabindex="4" placeholder="" /></td>
								<td class="td_3">标签文件ID</td>
							</tr-->
					
					<!--<span style="color:red;">*</span>-->
	        
					<tr class="tr_set" >
						<td class="td_1">
						</td>
						<td class="td_2">
						<button id="commit" class="login_commit" 
						name="新增"  type="submit" tabindex="100" >新   增</button>
						</td>
					</tr>
				 </tbody>
			 </table>
		</div>
	<!--  </form>-->
	
</div>
		 
		 
		 <div class="top_title mt10">
			<div style="float: left;">
				<span id="totaltag"></span>
			 </div>
			 <div style="float: left;display:none;">
				 <span id="totalsel">
				 </span>
				 &nbsp;&nbsp;<a href="#" onclick="dels()">批量删除</a>
			 </div>
			  <!--span  style="float:left;">
			 	 &nbsp;&nbsp;&nbsp;
			 	<a href="/sxb/oss/labeladd.shtml" target="_self">新增标签&gt;</a>
			 </span-->
			 <!--span>&nbsp;&nbsp;&nbsp;</span>
			 <span  style="float:right;">
			 	<a id="print2"  href="#" target="_self">A4连续打印预览&gt;</a>&nbsp;&nbsp;&nbsp;
			 </span>
			 <span  style="float:right;">
			 	<a id="hprint2"  href="#" target="_self">热敏纸连续打印预览&gt;</a>&nbsp;&nbsp;&nbsp;
			 </span>
			<span  style="float:right;">
			 	<a id="wprint2"  href="#" target="_self">A4连续打印预览(报关签条)&gt;</a>&nbsp;&nbsp;&nbsp;
			 </span-->
		 </div>
		   <div id="wait" style="display:none;text-align:center;	width:840px;	padding-left:20px;">
		   		<img src="/track/image/waiting.jpg" width="35" height="35"/><p class="wait_set">努力查询中</p>
		   </div>
		   <div class="table_body">
		   <table id="list" >
		   	<thead class="table_title">
		   		<tr class="tr_pad" style="text-align: left;height: 32px;">
		   		<th class="w0">
		   			<input  type="checkbox" >
		   		</th>
					<th class="w1">职位名称</th>
					<th class="w1">标签名称</th>
					<th class="w99">操作</th>
		   		</tr>
		   	</thead>
			   <tbody>
			   <!--tr class="tr_pad">
			     <td class="w1"></td>
			     <td class="w2"></td>
			     <td class="w3">
				     <select>
				     		<option onclick="javascript:alert('dddd');">aaaa</option>
				     		<option selected="selected">bbbb</option>
				     </select>
			     </td>
			     <td class="w4"></td>
			     <td class="w5"></td>
			     <td class="w6"></td>
			     <td class="w7">
			     <a href="#" target="_blank" class="ck">查看</a>
			     <a href="#" target="_blank" class="ck">编辑</a>
			     <a href="#" target="_blank" class="ck">签收</a>
			     </td>
			   </tr-->
			</tbody>
		 </table>
		 </div>
		<div id="pages" class="pages mt10" align="right">
		</div>
	 </div>
 </div>
 
  <!--#include virtual="/sxb/oss/foot.html"-->
  
  <script>
  var totalsize=0;
  
  $("#txtStart").datepicker(//绑定开始日期
	{
			  changeMonth:true,//显示下拉列表月份
		      changeYear:true,//显示下拉列表年份
			  showWeek:true,//显示日期对应的星期
			  firstDay:"1",
			  onSelect: function(dateText, inst){
			//设置结束日期的最小日期
			 $('#txtEnd').datepicker('option','minDate',new Date(dateText.replace('-',',')))	
			  }
	});

  $("#txtEnd").datepicker(//绑定结束日期
 {
			  changeMonth:true,//显示下拉列表月份
		      changeYear:true,//显示下拉列表年份
			  showWeek:true,//显示日期对应的星期
			  firstDay:"1",
			  onSelect: function(dateText, inst){
			//设置开始日期的最大日期
			 	$('#txtStart').datepicker('option','maxDate',new Date(dateText.replace('-',',')))	
			  },
			 defaultDate:new Date()
 });
  
if(GetCookie("stime")!=null)
{
	  $("#txtStart").val(GetCookie("stime"));
} else
{
	  $("#txtStart").val(getNowFormatDate());
}

if(GetCookie("etime")!=null)
{
	  $("#txtEnd").val(GetCookie("etime"));
} else
{
	  $("#txtEnd").val(getNowFormatDate());
}
 
  if(GetCookie("fisprint")=="0")
  {
	  $("#fisprint option[value='0']").attr("selected", "selected");
  } 
  if(GetCookie("fisprint")=="1")
  {
	  $("#fisprint option[value='1']").attr("selected", "selected");
  } 
  
  function list_cb(data)
  {
	  $("#wait").css("display","none");
	  $(".table_body").css("display","block");
	//alert(data.items.totalsize);
	var html_str="";
	for(var i=0;i<data.itemsize;i++)
	{
		/*var tel = data.items.item[i].FCONSIGNEETEL;
  		if(data.items.item[i].FCONSIGNEETEL==null || data.items.item[i].FCONSIGNEETEL=='undefined')
  		{
  			tel=data.items.item[i].FCONSIGNEEPHONE;
  		}*/
		
		html_str+='<tr id="'+data.items[i].FID+'" class="tr_pad" >'
		 	+'<td class="w0"><input type="checkbox" onchange="inputChange()"></td>'
				+'<td class="w1">' +data.items[i].FNAME+'</td>'
				+'<td class="w1">' +data.items[i].FLABELNAME+'</td>'
				+'<td class="w99">'
		     //+'<a href="/sxb/oss/labeledit.shtml?m='+data.items.item[i].FID+'">编辑</a>'
		   	 +'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:del(\''+data.items[i].FID
		     +'\');" target="_self" class="ck">删除</a>'
		     +'</td>'
		   +'</tr>';
	}
	totalsize=data.itemsize;
	if(totalsize==null || totalsize=="undefined" || totalsize == "" )
	{
		totalsize="0";
	}
	$("#totaltag").html("<span style='color:666666#;font-size:12px;'>共 "+totalsize+" 条符合条件的记录</span>")
	$("#list>tbody").html(html_str);
	
	// 加上分页
	//showPages3("pages", "list", data.pageSize, data.pageNo, data.pageTotalSize,data.items.totalsize);
  }
  
  function list_error_cb(data )
  {
	  alert(data.msg);
	  $("#wait").css("display","none");
	  $(".table_body").css("display","block");
  }
  
  function list(pagesize,pageno)
  {
	  $("#wait").css("display","block");
	  $(".table_body").css("display","none");
	  //var fisprint=$("#fisprint").val();
	  var param={};
	  param.pageno=pageno;
	  param.pagesize=pagesize;
	  param.fjobid=getRequest().m;
	  // param.fisprint=fisprint;
	  // param.stime=$("#txtStart").val();
	  // param.etime=$("#txtEnd").val();
	  // SetCookie("fisprint", fisprint);
	  // SetCookie("stime", param.stime);
	  // SetCookie("etime", param.etime);
	  var url="/sx/job/findjoblabel";
	  fn_ajax_error(url,param,"post","list_cb","list_error_cb");
  }
  
  var pageSize=GetCookie("pageSize");
  if(pageSize==null || pageSize=="" || pageSize=='undefined')
  {
	  pageSize=20;
  }  
  
 list(pageSize,1);
  
 $(".submit_1").click(function()
{
	 		list(pageSize,1);
	 		return false;
 });
  </script>
  <script>
  function del_callback(data)
  {
	  alert("成功删除");
	  //$("#"+data.FID).remove();
	  list(pageSize,1);
  }
  
  function del(fid)
  {
	  if(fid==null || fid == "" )
	  {
		  alert("ID不能为空");
		  return false;
	  } 
	  
	  var param={};
	  param.fid=fid;
	  var url="/sx/job/dellabel";
	  fn_ajax(url,param,"post","del_callback");
  }
  
  function dels_callback(data)
  {
	  alert("成功删除");
	  
	  for(var i=0;i<data.FID.length;i++)
		{
		  $("#"+data.FID[i]).remove();   
		} 
	  
	  $("#totaltag").parent().css("display","block");
	  $("#totalsel").parent().css("display","none");
  }
  
  function dels()
  {
	  var postids=getPostids();
	  if(postids==null || postids=="")
	  {
		  alert("请选择至少一条待删除的记录");
		  return;
	  } 
	  var param={};
	  param.fids=postids;
	  var url="/sx/$name}/dels";
	  fn_ajax(url,param,"post","dels_callback");
  }
  
  function check_callback(data)
  {
	  alert(data.msg);
	  var checkopt="未打印";
	  if(data.fisprint=="1")
	  {
		  checkopt="已打印";
	  }
	  
	  $("#"+data.fid+"> .w7 > .check").text(checkopt);
  }
  function checkopt(fid)
  {
	 var fisprint="1";
	 var check=$("#"+fid+"> .w7 >a").text();
	 if(check=="已打印")
	 {
		 fisprint="0";
	  }
	  var param={};
	  param.fid=fid;
	  param.fisprint=fisprint;
	  var url="/shop/track/update";
	  fn_ajax(url,param,"post","check_callback");
  }
  
  function inputChange()
  {
	costTotalSel();
  }
  
  $("th>input").change(function(){
	// alert($("th>input").attr("checked"));
	 if($("th>input").attr("checked")=="checked")
	{
		 //alert("selected");
		 $("td>input").attr("checked","checked");
	}else
	{
		 $("td>input").removeAttr("checked");
	}
	costTotalSel();
  });
  
  // 计算选择的总数
  function costTotalSel()
  {
	  var postids="";
	  var size=0;
	  $("td>input:checkbox:checked").each(function()
	  {
		  size++;
		  postids+=$(this).parent().parent().attr("id")+",";
		  //alert($(this).parent().parent().attr("id")); 		
	  });
	  //alert(postids.substring(0, postids.length-1));
	  postids=postids.substring(0, postids.length-1);
	  //return size;
	  if(size!=0)
	  {	  
	  	$("#totalsel").html("<span style='color:666666#;font-size:12px;'>您已选择了 "+size+" 条符合条件的记录</span>");
	  	$("#totaltag").parent().css("display","none");
	  	$("#totalsel").parent().css("display","block");
	  }else
	  {
		  $("#totalsel").html("<span style='color:666666#;font-size:12px;'>您已选择了 "+size+" 条符合条件的记录</span>");
		  $("#totaltag").parent().css("display","block");
		  $("#totalsel").parent().css("display","none");
	  }
  }
  
  function getPostids()
  {
	  var postids="";
	  var size=0;
	  $("td>input:checkbox:checked").each(function()
	  {
		  size++;
		  postids+=$(this).parent().parent().attr("id")+",";
		  //alert($(this).parent().parent().attr("id")); 		
	  });
	  //alert(postids.substring(0, postids.length-1));
	  postids=postids.substring(0, postids.length-1);
	  return postids;
	
  }
  
  	function info(fid)
	{
		window.location="/sxb/oss/labelinfo.shtml?m="+fid;
	}
  	
  	
  	
  	 function listlabel_cb(data)
  	  {
  		var html_str="";
  		for(var i=0;i<data.items.totalsize;i++)
  		{
  			
  			html_str+='<option  value="'+data.items.item[i].FID+'" >'+data.items.item[i].FNAME+'</option>';
  		}
  		$("#flabels").html(html_str);
  	  }
  	  
  	  function listlabel_error_cb(data )
  	  {
  		  alert(data.msg);
  		  $("#wait").css("display","none");
  		  $(".table_body").css("display","block");
  	  }
  	  
  	  function listlabel(pagesize,pageno)
  	  {
  		  $("#wait").css("display","block");
  		  $(".table_body").css("display","none");
  		  //var fisprint=$("#fisprint").val();
  		  var param={};
  		  param.pageno=pageno;
  		  param.pagesize=pagesize;
  		  param.ftype='2';
  		  // param.stime=$("#txtStart").val();
  		  // param.etime=$("#txtEnd").val();
  		  // SetCookie("fisprint", fisprint);
  		  // SetCookie("stime", param.stime);
  		  // SetCookie("etime", param.etime);
  		  
  		  var url="/sx/label/list";
  		  fn_ajax_error(url,param,"post","listlabel_cb","listlabel_error_cb");
  	  }
  	  
  	listlabel(1000,1);
  	
  	//var redirect_url="/sxb/oss/label.shtml";
	function addjoblabel_cb(data)
	{
		alert("成功新增");
		 list(pageSize,1);
	  	//window.location=redirect_url;
	}
	
	function addjoblabel_error_cb(data)
	{
		alert(data.msg);
	}
		
	$("#commit").click(function(e){
		var url="/sx/job/addjoblabel",
					flabelid = $("#flabels").val(),
					fjobid=getRequest().m,
		input_data={
					flabelid : flabelid,
					fjobid: fjobid
		 };
		 
		if( flabelid == "")
		{
		  alert("未选中任何标签"); 
		  return false;
		}
	
		fn_ajax(url,input_data,"post","addjoblabel_cb","addjoblabel_error_cb");
	});
  </script>
</body>
</html>
