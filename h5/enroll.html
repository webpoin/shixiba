<!DOCTYPE html>
<html>
<head>
<!--meta-->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta content="admin@52track.net" name="author">
<meta content="实习吧" name="Description">
<meta content="实习吧" name="Keywords">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" />
<meta content="telephone=no" name="format-detection" />
<title>实习吧-报名</title>
<link rel="stylesheet" href="jqm/jquery.mobile-1.4.5.min.css" />
<link rel="stylesheet" href="css/t.css" />
<script src="js/jquery.js"></script>
<script src="jqm/jquery.mobile-1.4.5.min.js"></script>
<script src="js/wuliu.js"></script>
<script src="js/comm_page.js"></script>
<style type="text/css">
.top_set1{
   top:0.25em !important;}	
.back_arrow{
	height:20px !important;
	width:auto;} 
.ba_color{
	background-color:#f9f9f9;}   
.e_ul_li_set li{
	text-align:center;
	border-width:0 0 1px;
	border-style:solid;
	padding:0.5em 0 !important;
	border-color:#dddddd;
}
#next1 li{
	border-width:0 0 1px !important;
	}		
.content_set{
	text-indent:2em !important;}
.ui-checkbox{
	width:10.5%;}	
.font_s1{
	font-size:1.2em !important;}
.color_s1{
	color:#999999;}
.color_s2 span {
    background: none repeat scroll 0 0 #dddddd;
    padding: 0 0.5em;
}
.d_img_set{
	margin:0.5em 0;}				
.img-set1{
	width:64px;
	height:64px;
	margin-right:0.5em;}
.d_min_set{
	display:block;
	float:left;
	width:100%;
	font-size:0.75em;
	margin:1em 0 0.3em;}	
.min_p{
	height:0.75em;
	width:auto;}
.d_l_t_set textarea{
	float:left;
	width:99%;
	height:160px;
	border:1px solid #21D0C6;}	
.d_wo_set{
    bottom: 1em;
    position: absolute;
    right: 2em;
	font-size:0.75em;
	color:#21D0C6;
	}
#info{
	resize:none;}
.box_div,#userlabel,.box_span,.box_span span{
	float:left;
	display:block;}
#userlabel,.box_span{
	margin-bottom:0.3em;}		
.box_span span{
	margin-right:0.3em;}	
#showlabel,#addlabel{
	font-size:1.2em;
    background-color:#dddddd;
    color:#999999 !important;
	padding:0 1.2em !important;}
#label{
    border: 1px solid #dddddd;
    height: 1.3em;
    width: 4.8em;}	
#next_set a{
    background-color:#21D0C6!important;
    border: medium none !important;
    color: #ffffff !important;
	text-align:center;
    text-shadow: none !important;
	font-size:1.2em;
}
#next_set a:focus {
    box-shadow: 0 0 0 #21D0C6 !important;
}					
.f_no_bo{
	border:none;}
#userpic{
	display:block;
	float:left;}	
.row{
	display:block;
	float:left;
	width:64px;
	height:64px;
	}	
#fileToUpload{
    opacity: 0;
    position: absolute;
    height:64px;
    width: 64px;
    z-index: 999;
	}
.btn_add{
	text-align:center;
	font-size:48px;
	color:#dddddd;
    width:62px;
	background-color:#f9f9f9;
	border:1px solid #dddddd;}		
</style>

</head>
<body>
<script>sxbIsLogin();</script>
<div data-role="page" id="pagehome" data-title="实习吧-报名">

<div data-role="header" data-position="fixed" data-theme="f">
<a  href="javascript:void()" class="b_c_set top_set1" data-rel="back" data-role="none"
		 data-add-back-btn="true"><img class="back_arrow" src="images/arrow_green.png"/></a>
<h1  id="ftitle"></h1>
</div>

<div data-role="content">
	<span id="fuserid" style="display: none;"></span>
  <div data-role="navbar" class="ba_color">
	    <ul class="e_ul_li_set" >
	      <li style="width:27%"><span style="color:#21D0C6;">填写资料</span></li>
	      <li style="width:5%"><span style="color:#999999;">&gt;</span></li>
	      <li style="width:36%"><span style="color:#999999;">确认联系方式</span></li>
	       <li style="width:5%"><span style="color:#999999;">&gt;</span></li>
	      <li style="width:27%"><span  style="color:#999999;">传递简历</span></li>
		</ul>
    </div>
	<span id="fid" style="display: none;"></span>
  <ul id="next1" data-role="listview">
	<li>
    <div>
        <span class="font_s1">报名：</span>
        <span class="font_s1" id="fname"></span>
    </div>
	</li>
  
	 <li>
      <form method="post" action="#" class="d_l_t_set">
	    <label for="info" class="color_s1">报名理由：</label>
	    <textarea name="addinfo" id="info" data-role="none"></textarea>
      </form>
      <div class="d_wo_set"><span id="word">0</span>/<span>140</span></div>
       </li>
  
  
    <li>
   
    <div>
       <span class="font_s2 color_s1">真实姓名：</span>
       <span class="font_s2" id="fusername"></span
    ></div>
    <div class="d_img_set">
    	<span id="userpic">
	    <!--img class="img-set1 pi-1" src="images/text1.jpg" alt="图片1" />
	    <img class="img-set1 pi-2" src="images/text1.jpg" alt="图片2" /-->
        </span>
        <div class="row">
	   <form id="form1" enctype="multipart/form-data" method="post" action="/" >
			<!--div class="row">
		     	<label for="fileToUpload">Select a File to Upload</label-->
				<input type="file" name="fileToUpload" id="fileToUpload" onchange="uploadFile();" data-role="none" value="增加"/>
                <div class="btn_add">+</div>
			<!--/div>			
			<div class="row">
				<input type="button" onclick="uploadFile()" value="Upload" />
			</div-->
			<div id="progressNumber"></div>
		</form>
	    </div>
    </div>
    <div class="d_min_set color_s1">
    <img class="min_p" src="images/icon_picture.png" alt="+" />
    <span>已存<span id="totalpic">0</span>张，最多存3张，每张不超过1M</span>
    </div>
    </li>
     
	  <li class="li_span_set">
	   </li>
	 
	 
       <!--li>
         <p class="color_s1">个人标签：</p>
         <p class="font_s1 color_s2">
            <span>文艺</span>
		    <span>旅行</span>
		    <span>饮食</span>
         </p>
        </li-->
         <li class="li_span_set">
         <p class="color_s1 f_set1em">个人标签：</p>
         <div class="box_div">
         <div id="userlabel" class="font_s1 color_s2">
            <!--span>文艺</span>
		    <span>旅行</span>
		    <span>饮食</span-->
            </div>
          <div class="box_span">  
         <span id="showlabel">+</span>
         <span id="span_input" style="display: none;">
         <input id="label" type="text" data-role="none"></span>
         <span id="addlabel" style="display:none;">确定</span>
          </div>
          </div>
        </li>
        <!--li>
         <p class="color_s1 f_set1em">个人标签：</p>
         <p id="userlabel" class="font_s1 color_s2">
            <!--span>文艺</span>
		    <span>旅行</span>
		    <span>饮食</span>
         </p>
         	<a id="showlabel" href="#"  data-role="none">+</a>
         	<input id="label" type="text" style="display: none;">
         	<a id="addlabel" href="#" data-role="none" style="display: none;">+</a>
        </li-->
        
    </ul>
    
    <ul id="next2" data-role="listview" data-inset="true" class="u_li_z" style="display:none;">
      <li>
    <div>
        <span class="font_s1">报名：</span>
        <span class="font_s1" id="fname">希腊招募中餐厅服务员</span>
    </div>
    <div style="margin-top:0.5em; font-size:0.75em;">
       <span class="font_s2 color_s1">丨请确认联系信息准确无误,以方便实习吧联系到你</span>
    </div>
      </li>
           <li>
	 <form method="post" action="#">
       <div data-role="fieldcontain">
        <label for="email" class="label_set">邮箱：</label>
        <!-- 0440081057555   561276-->
        <input type="email"  id="email" placeholder="请输入您的邮箱" value="" data-role="none" class="pho_set" >
        <input class="submit_set" type="submit" data-inline="true" value="修改" data-role="none"  >
        </div>
        </form>
        </li>
<li>
	<form method="post" action="#">
    <div data-role="fieldcontain">
        <label class="label_set" for="accoint">电话：</label>
        <!-- 0440081057555   561276-->
        <input type="text" data-role="none" id="account" placeholder="请输入您的手机号码" value="" class="pho_set">
        <input class="submit_set" type="submit" data-inline="true" value="确认" data-role="none"  >
        </div>
      </form> 
      </li>
    </ul>
    
    </div>
<div id="popdiv" data-role="popup"></div><!--弹出层,默认不显示-->
<div data-role="footer" data-position="fixed" class="f_no_bo">
<div data-role="navbar">
 <ul>
     <li id="next_set"><a href=""  data-transition="none" id="next" >下一步</a></li>
 </ul>
 </div>
</div>
</div>
<script>
showUser();
function job_cb(data)
{
	$("#fid").text(data.FID);
	$("#fname").text(data.FNAME);
	$("#ftitle").text(data.FNAME);
	return;
}

function job()
{
	  var param={};
	  var fid=sessionStorage.m;
	  param.fid=fid;
	  var url="/sx/job/query";
	  fn_ajax(url,param,"post","job_cb");
}

job();

var redirect_url="/sxb/enroll2.html";
function enroll_cb(data)
{
	 //alert("成功报名");
	 //$("#next1").css("display", "none");
	 //$("#next2").css("display", "block");
 	 window.location.href=redirect_url;//+"?m="+data.FID;
 	 if(data.FID!=null)
 	 {
 		sessionStorage.fapplyid=data.FID;
 	 }else
 	{
 		sessionStorage.fapplyid=data.fid;
 	}	 
 	 
}
	
$("#next").click(function(e){
	var ffileids="";
	$("#userpic").find("img").each(function()
	{
		var id=$(this).attr("id");
		if(id!=null && id!="undefined"  && id!="")
		{	
			ffileids+=$(this).attr("id")+":";
		}
	});
	if(ffileids!="")
	{
		ffileids = ffileids.substring(0, ffileids.length-1);
	}
	
	var url="/sx/apply/add",
				fid = $("#fid").text(),
				info = $("#info").val(),
	input_data={
				fjobid : fid,
				freason : info,
				ffileids:ffileids
	 };
	 
	if( fid == "")
	{
	  pop("职位ID不能为空"); 
	  return false;
	}
	
	fn_ajax(url,input_data,"post","enroll_cb");
});

function ok_showuser(data)
{
	$("#fuserid").text(data.fid);
	$("#femail").val(data.femail);
	$("#ftel").val(data.ftel);
	$("#fusername").text(data.fname);
	
	listuserpic();
}
function error_showuser()
{
	window.location.href="login.html?url="+"/sxb/enroll.html";
}
function showUser()
{
	  var param={};
	  param.usertype="1";
	  var url="/sx/islogin?url="+window.location.href;	  
	  var errorCallback="error_showuser";
	  fn_ajax_error_async(url,param,"post","ok_showuser",errorCallback,"1");
	  return false;
}


$(function(){
  $("#info").keyup(function(){
   var len = $(this).val().length;
   if(len > 139){
    $(this).val($(this).val().substring(0,140));
   }
   var num =0 + len;
   if(num < 141){
   $("#word").text(num);}
  });
 });

 
 function listuserpic_cb(data)
{
	var html_str="";
	if(data.itemsize==null || data.itemsize=="undefined")
	{
		data.itemsize=0;
	}	
	for(var i=0;i<data.itemsize;i++)
	{
		html_str+='<img id="'+data.items[i].FFILEID+'" class="img-set1 pi-1" src="/sxb/images/'+data.items[i].FNAME+'" alt="" />';
	}
	$("#userpic").html(html_str);
	
	$("#totalpic").text(data.itemsize);
}

function listuserpic_error_cb(data )
{
	  //pop(data.msg);
}

function listuserpic()
{
	  var param={};
	  var url="/sx/userpic/listallby";
	  fn_ajax_error(url,param,"post","listuserpic_cb","listuserpic_error_cb");
}

function uploadFile() {
	if($("#userpic>img").length>=3)
	{
		pop("最多只能上传3张图片");
		return false;
	}	
	
    var fd = new FormData();
    fd.append("fileToUpload", document.getElementById('fileToUpload').files[0]);
    var xhr = new XMLHttpRequest();
    xhr.upload.addEventListener("progress", uploadProgress, false);
    xhr.addEventListener("load", uploadComplete, false);
    xhr.addEventListener("error", uploadFailed, false);
    xhr.addEventListener("abort", uploadCanceled, false);
    xhr.open("POST", "/sx/uploadnew");
    xhr.send(fd);
  }

  function uploadProgress(evt) {
   /* if (evt.lengthComputable) {
      var percentComplete = Math.round(evt.loaded * 100 / evt.total);
      document.getElementById('progressNumber').innerHTML = percentComplete.toString() + '%';
    }
    else {
      document.getElementById('progressNumber').innerHTML = 'unable to compute';
    }*/
  }

  function uploadComplete(evt) {
    /* This event is raised when the server send back a response */
   //alert("Ddddddddddddddd");
   var res  =jQuery.parseJSON(evt.target.responseText);
   //alert(res);
   var data = res.data;
   var html_str=$("#userpic").html();
   html_str+='<img id="'+data.items[0].fid+'" class="img-set1 pi-1" src="/sxb/images/'+data.items[0].fname+'" alt="" />';
   $("#userpic").html(html_str);
   
   $("#totalpic").text($("#userpic>img").length);
   
   // alert(evt.target.responseText);
  }

  function uploadFailed(evt) {
    pop("There was an error attempting to upload the file.");
  }

  function uploadCanceled(evt) {
    pop("The upload has been canceled by the user or the browser dropped the connection.");
  }
  
  
  function ok_label(data)
  {
  	var html_str="";
  	for(var i=0;i<data.items.length;i++)
  	{
  		html_str+='<span  id="'+data.items[i].fid+'" onclick="delUserLabel(this)">'+data.items[i].fname+'</span>&nbsp;';
  	}
  	$("#userlabel").html(html_str);
  }

  function error_label(data)
  {
  	//$("#userlabel").text("");
  }

  function getLabels()
  {
  	  var param={};
  	  var url="/sx/label/queryuser";
  	  var errorCallback="error_label";
  	  fn_ajax_error_async(url,param,"post","ok_label",errorCallback,"1");
  	  return false;
  }
  getLabels();
  function ok_addlabel(data)
  {
  	$("#span_input").css("display","none");
  	$("#addlabel").css("display","none");
  	var html_str="";
  	html_str='<span id="'+data.fid+'" onclick="delUserLabel(this)">'+data.fname+'</span>&nbsp;';
  	$("#userlabel").append(html_str);
  }
  function error_addlabel(data)
  {
	  pop(data.msg);
  }
  $("#addlabel").click(function()
  {
  	  var param={};
  	  param.fname=$("#label").val();
  	  //alert(param.fname);
  	  var url="/sx/label/adduserlabel";
  	  var errorCallback="error_addlabel";
  	  fn_ajax_error(url,param,"post","ok_addlabel",errorCallback,"1");
  	  return false;
  });
  $("#showlabel").click(function()
  {
  	$("#span_input").css("display","block");
  	$("#addlabel").css("display","block");
  });
  function ok_dellabel(data)
  {
  	$("#"+data.fid).remove();
  	//$("#label").css("display","none");
  	//$("#addlabel").css("display","none");
  	//var html_str="";
  	//html_str='<span>'+data.fname+'</span>&nbsp;';
  	//$("#userlabel").append(html_str);
  }
  function error_dellabel(data)
  {
  }
  function delUserLabel(obj)
  {
  	  var param={};
  	  param.fid=$(obj).attr("id");
  	  var url="/sx/label/deluserlabel";
  	  var errorCallback="error_dellabel";
  	  fn_ajax_error(url,param,"post","ok_dellabel",errorCallback,"1");
  	  return false;
  }
</script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?933dcad2a62081671207ea9fa0d6623b";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
</body>
</html>